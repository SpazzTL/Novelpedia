import"../chunks/DsnmJJEf.js";import{i as Ba}from"../chunks/DxIE0uaL.js";import{l as Yt,b as Va,w as va,d as ye,c as I,o as Wa,e as K,a as U}from"../chunks/C-uSqT99.js";import{s as It,h as ue,a3 as Ua,i as ca,d as Qa,c as Ja,u as y,az as Xa,r as Ya,H as Ga,e as sa,f as qt,n as Ge,a4 as Ka,a8 as Za,j as Ut,l as ja,k as We,ac as ua,a1 as pa,t as es,aL as ra,aM as ts,m as da,p as as,aN as ss,aO as zt,aP as fa,aQ as rs,aR as is,a6 as ls,aS as ns,ab as os,aT as vs,$ as _a,at as ga,v as ba,aU as cs,aV as ha,E as us,aW as ps,aX as ds,B as ma,aY as fs,aZ as _s,a0 as Qt,o as Ke,a_ as gs,au as ya,a$ as bs,S as hs,Q as V,K as ms,R as W,V as u,X as v,P as q,T as ys,b0 as ws,b1 as ia,W as o,b2 as Re,J as la,M as Dt}from"../chunks/BDENE0cH.js";import{i as we,s as T,a as $s,b as J}from"../chunks/C0UzW-iV.js";import{r as $e,s as Ze}from"../chunks/D-wkWpY7.js";function je(e,a){return a}function ks(e,a,t){for(var r=e.items,i=[],l=a.length,s=0;s<l;s++)ns(a[s].e,i,!0);var m=l>0&&i.length===0&&t!==null;if(m){var S=t.parentNode;os(S),S.append(t),r.clear(),re(e,a[0].prev,a[l-1].next)}vs(i,()=>{for(var n=0;n<l;n++){var b=a[n];m||(r.delete(b.k),re(e,b.prev,b.next)),fa(b.e,!m)}})}function Be(e,a,t,r,i,l=null){var s=e,m={flags:a,items:new Map,first:null};{var S=e;s=ue?It(Ua(S)):S.appendChild(ca())}ue&&Qa();var n=null,b=!1,P=new Map,f=Xa(()=>{var h=t();return pa(h)?h:h==null?[]:ua(h)}),w,_;function p(){xs(_,w,m,P,s,i,a,r,t),l!==null&&(w.length===0?n?da(n):n=Ut(()=>l(s)):n!==null&&as(n,()=>{n=null}))}Ja(()=>{_??=_a,w=y(f);var h=w.length;if(b&&h===0)return;b=h===0;let $=!1;if(ue){var z=Ya(s)===Ga;z!==(h===0)&&(s=sa(),It(s),qt(!1),$=!0)}if(ue){for(var k=null,M,C=0;C<h;C++){if(Ge.nodeType===Ka&&Ge.data===Za){s=Ge,$=!0,qt(!1);break}var N=w[C],D=r(N,C);M=Jt(Ge,m,k,null,N,D,C,i,a,t),m.items.set(D,M),k=M}h>0&&It(sa())}if(ue)h===0&&l&&(n=Ut(()=>l(s)));else if(ja()){var X=new Set,R=We;for(C=0;C<h;C+=1){N=w[C],D=r(N,C);var de=m.items.get(D)??P.get(D);de?wa(de,N,C):(M=Jt(null,m,null,null,N,D,C,i,a,t,!0),P.set(D,M)),X.add(D)}for(const[fe,ke]of m.items)X.has(fe)||R.skipped_effects.add(ke.e);R.add_callback(p)}else p();$&&qt(!0),y(f)}),ue&&(s=Ge)}function xs(e,a,t,r,i,l,s,m,S){var n=a.length,b=t.items,P=t.first,f=P,w,_=null,p=[],h=[],$,z,k,M;for(M=0;M<n;M+=1){if($=a[M],z=m($,M),k=b.get(z),k===void 0){var C=r.get(z);if(C!==void 0){r.delete(z),b.set(z,C);var N=_?_.next:f;re(t,_,C),re(t,C,N),Rt(C,N,i),_=C}else{var D=f?f.e.nodes_start:i;_=Jt(D,t,_,_===null?t.first:_.next,$,z,M,l,s,S)}b.set(z,_),p=[],h=[],f=_.next;continue}if(wa(k,$,M),(k.e.f&zt)!==0&&da(k.e),k!==f){if(w!==void 0&&w.has(k)){if(p.length<h.length){var X=h[0],R;_=X.prev;var de=p[0],fe=p[p.length-1];for(R=0;R<p.length;R+=1)Rt(p[R],X,i);for(R=0;R<h.length;R+=1)w.delete(h[R]);re(t,de.prev,fe.next),re(t,_,de),re(t,fe,X),f=X,_=fe,M-=1,p=[],h=[]}else w.delete(k),Rt(k,f,i),re(t,k.prev,k.next),re(t,k,_===null?t.first:_.next),re(t,_,k),_=k;continue}for(p=[],h=[];f!==null&&f.k!==z;)(f.e.f&zt)===0&&(w??=new Set).add(f),h.push(f),f=f.next;if(f===null)continue;k=f}p.push(k),_=k,f=k.next}if(f!==null||w!==void 0){for(var ke=w===void 0?[]:ua(w);f!==null;)(f.e.f&zt)===0&&ke.push(f),f=f.next;var _e=ke.length;if(_e>0){var at=n===0?i:null;ks(t,ke,at)}}e.first=t.first&&t.first.e,e.last=_&&_.e;for(var st of r.values())fa(st.e);r.clear()}function wa(e,a,t,r){ts(e.v,a),e.i=t}function Jt(e,a,t,r,i,l,s,m,S,n,b){var P=(S&rs)!==0,f=(S&is)===0,w=P?f?es(i,!1,!1):ra(i):i,_=(S&ss)===0?s:ra(s),p={i:_,v:w,k:l,a:null,e:null,prev:t,next:r};try{if(e===null){var h=document.createDocumentFragment();h.append(e=ca())}return p.e=Ut(()=>m(e,w,_,n),ue),p.e.prev=t&&t.e,p.e.next=r&&r.e,t===null?b||(a.first=p):(t.next=p,t.e.next=p.e),r!==null&&(r.prev=p,r.e.prev=p.e),p}finally{}}function Rt(e,a,t){for(var r=e.next?e.next.e.nodes_start:t,i=a?a.e.nodes_start:t,l=e.e.nodes_start;l!==null&&l!==r;){var s=ls(l);i.before(l),l=s}}function re(e,a,t){a===null?e.first=t:(a.next=t,a.e.next=t&&t.e),t!==null&&(t.prev=a,t.e.prev=a&&a.e)}function $a(e,a,t=!1){if(e.multiple){if(a==null)return;if(!pa(a))return cs();for(var r of e.options)r.selected=a.includes(tt(r));return}for(r of e.options){var i=tt(r);if(ha(i,a)){r.selected=!0;return}}(!t||a!==void 0)&&(e.selectedIndex=-1)}function Ss(e){var a=new MutationObserver(()=>{$a(e,e.__value)});a.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ba(()=>{a.disconnect()})}function Ve(e,a,t=a){var r=!0;Yt(e,"change",i=>{var l=i?"[selected]":":checked",s;if(e.multiple)s=[].map.call(e.querySelectorAll(l),tt);else{var m=e.querySelector(l)??e.querySelector("option:not([disabled])");s=m&&tt(m)}t(s)}),ga(()=>{var i=a();if($a(e,i,r),r&&i===void 0){var l=e.querySelector(":checked");l!==null&&(i=tt(l),t(i))}e.__value=i,r=!1}),Ss(e)}function tt(e){return"__value"in e?e.__value:e.value}const Cs=()=>performance.now(),pe={tick:e=>requestAnimationFrame(e),now:()=>Cs(),tasks:new Set};function ka(){const e=pe.now();pe.tasks.forEach(a=>{a.c(e)||(pe.tasks.delete(a),a.f())}),pe.tasks.size!==0&&pe.tick(ka)}function Ts(e){let a;return pe.tasks.size===0&&pe.tick(ka),{promise:new Promise(t=>{pe.tasks.add(a={c:e,f:t})}),abort(){pe.tasks.delete(a)}}}function vt(e,a){va(()=>{e.dispatchEvent(new CustomEvent(a))})}function Es(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const a=e.split("-");return a.length===1?a[0]:a[0]+a.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function na(e){const a={},t=e.split(";");for(const r of t){const[i,l]=r.split(":");if(!i||l===void 0)break;const s=Es(i.trim());a[s]=l.trim()}return a}const As=e=>e;function et(e,a,t,r){var i=(e&fs)!==0,l="both",s,m=a.inert,S=a.style.overflow,n,b;function P(){return va(()=>s??=t()(a,r?.()??{},{direction:l}))}var f={is_global:i,in(){a.inert=m,vt(a,"introstart"),n=Xt(a,P(),b,1,()=>{vt(a,"introend"),n?.abort(),n=s=void 0,a.style.overflow=S})},out(h){a.inert=!0,vt(a,"outrostart"),b=Xt(a,P(),n,0,()=>{vt(a,"outroend"),h?.()})},stop:()=>{n?.abort(),b?.abort()}},w=_a;if((w.transitions??=[]).push(f),Va){var _=i;if(!_){for(var p=w.parent;p&&(p.f&us)!==0;)for(;(p=p.parent)&&(p.f&ps)===0;);_=!p||(p.f&ds)!==0}_&&ga(()=>{ma(()=>f.in())})}}function Xt(e,a,t,r,i){var l=r===1;if(_s(a)){var s,m=!1;return Qt(()=>{if(!m){var h=a({direction:l?"in":"out"});s=Xt(e,h,t,r,i)}}),{abort:()=>{m=!0,s?.abort()},deactivate:()=>s.deactivate(),reset:()=>s.reset(),t:()=>s.t()}}if(t?.deactivate(),!a?.duration)return i(),{abort:Ke,deactivate:Ke,reset:Ke,t:()=>r};const{delay:S=0,css:n,tick:b,easing:P=As}=a;var f=[];if(l&&t===void 0&&(b&&b(0,1),n)){var w=na(n(0,1));f.push(w,w)}var _=()=>1-r,p=e.animate(f,{duration:S,fill:"forwards"});return p.onfinish=()=>{p.cancel();var h=t?.t()??1-r;t?.abort();var $=r-h,z=a.duration*Math.abs($),k=[];if(z>0){var M=!1;if(n)for(var C=Math.ceil(z/16.666666666666668),N=0;N<=C;N+=1){var D=h+$*P(N/C),X=na(n(D,1-D));k.push(X),M||=X.overflow==="hidden"}M&&(e.style.overflow="hidden"),_=()=>{var R=p.currentTime;return h+$*P(R/z)},b&&Ts(()=>{if(p.playState!=="running")return!1;var R=_();return b(R,1-R),!0})}p=e.animate(k,{duration:z,fill:"forwards"}),p.onfinish=()=>{_=()=>r,b?.(r,1-r),i()}},{abort:()=>{p&&(p.cancel(),p.effect=null,p.onfinish=Ke)},deactivate:()=>{i=Ke},reset:()=>{r===0&&b?.(1,0)},t:()=>_()}}function Le(e,a,t=a){var r=gs(),i=new WeakSet;Yt(e,"input",l=>{var s=l?e.defaultValue:e.value;if(s=Vt(e)?Wt(s):s,t(s),We!==null&&i.add(We),r&&s!==(s=a())){var m=e.selectionStart,S=e.selectionEnd;e.value=s??"",S!==null&&(e.selectionStart=m,e.selectionEnd=Math.min(S,e.value.length))}}),(ue&&e.defaultValue!==e.value||ma(a)==null&&e.value)&&(t(Vt(e)?Wt(e.value):e.value),We!==null&&i.add(We)),ya(()=>{var l=a();if(e===document.activeElement){var s=bs??We;if(i.has(s))return}Vt(e)&&l===Wt(e.value)||e.type==="date"&&!l&&!e.value||l!==e.value&&(e.value=l??"")})}const Bt=new Set;function Ms(e,a,t,r,i=r){var l=t.getAttribute("type")==="checkbox",s=e;let m=!1;if(a!==null)for(var S of a)s=s[S]??=[];s.push(t),Yt(t,"change",()=>{var n=t.__value;l&&(n=oa(s,n,t.checked)),i(n)},()=>i(l?[]:null)),ya(()=>{var n=r();if(ue&&t.defaultChecked!==t.checked){m=!0;return}l?(n=n||[],t.checked=n.includes(t.__value)):t.checked=ha(t.__value,n)}),ba(()=>{var n=s.indexOf(t);n!==-1&&s.splice(n,1)}),Bt.has(s)||(Bt.add(s),Qt(()=>{s.sort((n,b)=>n.compareDocumentPosition(b)===4?-1:1),Bt.delete(s)})),Qt(()=>{if(m){var n;if(l)n=oa(s,n,t.checked);else{var b=s.find(P=>P.checked);n=b?.__value}i(n)}})}function oa(e,a,t){for(var r=new Set,i=0;i<e.length;i+=1)e[i].checked&&r.add(e[i].__value);return t||r.delete(a),Array.from(r)}function Vt(e){var a=e.type;return a==="number"||a==="range"}function Wt(e){return e===""?null:+e}const Ns=e=>e;function Ls(e){const a=e-1;return a*a*a+1}function ct(e,{delay:a=0,duration:t=400,easing:r=Ns}={}){const i=+getComputedStyle(e).opacity;return{delay:a,duration:t,easing:r,css:l=>`opacity: ${l*i}`}}function Fs(e,{delay:a=0,duration:t=400,easing:r=Ls,axis:i="y"}={}){const l=getComputedStyle(e),s=+l.opacity,m=i==="y"?"height":"width",S=parseFloat(l[m]),n=i==="y"?["top","bottom"]:["left","right"],b=n.map($=>`${$[0].toUpperCase()}${$.slice(1)}`),P=parseFloat(l[`padding${b[0]}`]),f=parseFloat(l[`padding${b[1]}`]),w=parseFloat(l[`margin${b[0]}`]),_=parseFloat(l[`margin${b[1]}`]),p=parseFloat(l[`border${b[0]}Width`]),h=parseFloat(l[`border${b[1]}Width`]);return{delay:a,duration:t,easing:r,css:$=>`overflow: hidden;opacity: ${Math.min($*20,1)*s};${m}: ${$*S}px;padding-${n[0]}: ${$*P}px;padding-${n[1]}: ${$*f}px;margin-${n[0]}: ${$*w}px;margin-${n[1]}: ${$*_}px;border-${n[0]}-width: ${$*p}px;border-${n[1]}-width: ${$*h}px;min-${m}: 0`}}var Os=V('<link rel="preconnect" href="https://fonts.googleapis.com" class="svelte-1itbpge"/> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous" class="svelte-1itbpge"/> <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap" rel="stylesheet" class="svelte-1itbpge"/>',1),Ps=V('<li role="button" tabindex="0" class="svelte-1itbpge"> </li>'),Hs=V('<ul class="suggestions-list svelte-1itbpge"></ul>'),Is=V('<li role="button" tabindex="0" class="svelte-1itbpge"> </li>'),qs=V('<ul class="suggestions-list svelte-1itbpge"></ul>'),zs=V('<li role="button" tabindex="0" class="svelte-1itbpge"> </li>'),Ds=V('<ul class="suggestions-list svelte-1itbpge"></ul>'),Rs=V('<label class="tag-checkbox svelte-1itbpge"><input type="checkbox" class="svelte-1itbpge"/> <span class="svelte-1itbpge"> </span></label>'),Bs=V('<div class="filter-panel svelte-1itbpge"><fieldset class="svelte-1itbpge"><div class="autocomplete-wrapper svelte-1itbpge"><input type="search" placeholder="Search title or ID..." class="svelte-1itbpge"/> <!></div> <div class="autocomplete-wrapper svelte-1itbpge"><input type="search" placeholder="Author name..." class="svelte-1itbpge"/> <!></div> <div class="autocomplete-wrapper svelte-1itbpge"><input type="search" placeholder="Must have this tag..." class="svelte-1itbpge"/> <!></div></fieldset> <fieldset class="tag-fieldset svelte-1itbpge"><legend class="svelte-1itbpge">Include at least ONE of these tags</legend> <div class="tag-container svelte-1itbpge"></div> <button class="secondary svelte-1itbpge">Clear Tags</button></fieldset> <fieldset class="grid-fieldset svelte-1itbpge"><div class="svelte-1itbpge"><label for="min-chapters" class="svelte-1itbpge">Chapters</label> <div class="range-inputs svelte-1itbpge"><input id="min-chapters" type="number" placeholder="Min" class="svelte-1itbpge"/> <span class="svelte-1itbpge">-</span> <input type="number" placeholder="Max" class="svelte-1itbpge"/></div></div> <div class="svelte-1itbpge"><label for="min-likes" class="svelte-1itbpge">Likes ❤️</label> <div class="range-inputs svelte-1itbpge"><input id="min-likes" type="number" placeholder="Min" class="svelte-1itbpge"/> <span class="svelte-1itbpge">-</span> <input type="number" placeholder="Max" class="svelte-1itbpge"/></div></div> <div class="svelte-1itbpge"><label for="adult-filter" class="svelte-1itbpge">Audience</label> <select id="adult-filter" class="svelte-1itbpge"><option class="svelte-1itbpge">Any Audience</option><option class="svelte-1itbpge">General</option><option class="svelte-1itbpge">Adult Only</option></select></div> <div class="svelte-1itbpge"><label for="status-filter" class="svelte-1itbpge">Status</label> <select id="status-filter" class="svelte-1itbpge"><option class="svelte-1itbpge">Any Status</option><option class="svelte-1itbpge">Completed</option><option class="svelte-1itbpge">Ongoing</option></select></div> <div class="svelte-1itbpge"><label for="cover-filter" class="svelte-1itbpge">Cover Art</label> <select id="cover-filter" class="svelte-1itbpge"><option class="svelte-1itbpge">Show All</option><option class="svelte-1itbpge">With Cover Only</option></select></div></fieldset></div>'),Vs=V('<div class="status-message svelte-1itbpge"><div class="spinner svelte-1itbpge"></div> <p class="svelte-1itbpge">Loading novel data...</p></div>'),Ws=V('<div class="status-message error svelte-1itbpge"><p class="svelte-1itbpge"> </p></div>'),Us=V('<div class="status-message svelte-1itbpge"><p class="svelte-1itbpge">No novels found matching your criteria.</p></div>'),Qs=V('<span class="adult-badge svelte-1itbpge">19</span>'),Js=V('<span class="tag svelte-1itbpge"> </span>'),Xs=V('<a target="_blank" rel="noopener noreferrer" class="card-link svelte-1itbpge"><div class="card svelte-1itbpge"><div class="card-cover svelte-1itbpge"><!> <img loading="lazy" class="svelte-1itbpge"/> <div class="cover-placeholder svelte-1itbpge"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="svelte-1itbpge"><path d="M4 5h16v11H4V5zm15 13H5a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v12a1 1 0 0 1-1-1zM3 19h18v2H3v-2zM8.5 10.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zM19 14l-4.5-6-3.5 4.5-2-2.5-4 5h14z" class="svelte-1itbpge"></path></svg> <span class="svelte-1itbpge">No Cover</span></div></div> <div class="card-content svelte-1itbpge"><h2 class="svelte-1itbpge"> </h2> <p class="author svelte-1itbpge"> </p> <p class="synopsis svelte-1itbpge"> </p> <div class="tags svelte-1itbpge"></div> <div class="card-footer svelte-1itbpge"><span class="svelte-1itbpge"> </span> <span class="svelte-1itbpge"> </span> <span class="svelte-1itbpge"> </span></div></div></div></a>'),Ys=V('<div class="grid svelte-1itbpge"></div> <div class="pagination bottom svelte-1itbpge"><button class="svelte-1itbpge">⬅ Prev</button> <span class="svelte-1itbpge"> </span> <button class="svelte-1itbpge">Next ➡</button></div>',1),Gs=V('<main class="svelte-1itbpge"><header class="svelte-1itbpge"><h1 class="svelte-1itbpge">📚 Novelpedia Browser</h1> <p class="subtitle svelte-1itbpge">Search and filter through the Novelpia metadata library.</p></header> <section class="controls svelte-1itbpge"><button class="toggle-filters svelte-1itbpge"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18" class="svelte-1itbpge"><path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z" class="svelte-1itbpge"></path></svg> </button></section> <!> <section class="results-header svelte-1itbpge"><div class="sort-controls svelte-1itbpge"><label for="sort-by" class="svelte-1itbpge">Sort by</label> <select id="sort-by" class="svelte-1itbpge"><option class="svelte-1itbpge">Likes</option><option class="svelte-1itbpge">Chapters</option><option class="svelte-1itbpge">Title</option></select> <select class="svelte-1itbpge"><option class="svelte-1itbpge">Descending</option><option class="svelte-1itbpge">Ascending</option></select></div> <div class="pagination svelte-1itbpge"><button class="svelte-1itbpge">⬅ Prev</button> <span class="svelte-1itbpge"> </span> <button class="svelte-1itbpge">Next ➡</button></div> <div class="per-page-controls svelte-1itbpge"><select aria-label="Results per page" class="svelte-1itbpge"><option class="svelte-1itbpge">20/page</option><option class="svelte-1itbpge">50/page</option><option class="svelte-1itbpge">100/page</option></select></div></section> <!></main>');function sr(e,a){hs(a,!1);const[t,r]=$s(),i=()=>T(Gt,"$showFilters",t),l=()=>T(Fe,"$query",t),s=()=>T(Ta,"$titleSuggestions",t),m=()=>T(Oe,"$authorQuery",t),S=()=>T(Ea,"$authorSuggestions",t),n=()=>T(xe,"$mustHaveTag",t),b=()=>T(Aa,"$tagSuggestions",t),P=()=>T(Ma,"$topTags",t),f=()=>T(rt,"$selectedTags",t),w=()=>T(dt,"$minChapters",t),_=()=>T(ft,"$maxChapters",t),p=()=>T(_t,"$minLikes",t),h=()=>T(gt,"$maxLikes",t),$=()=>T(ut,"$showAdult",t),z=()=>T(pt,"$status",t),k=()=>T(bt,"$withCoverOnly",t),M=()=>T(ht,"$sortBy",t),C=()=>T(mt,"$sortDir",t),N=()=>T(Se,"$currentPage",t),D=()=>T(La,"$totalPages",t),X=()=>T(it,"$perPage",t),R=()=>T(st,"$isLoading",t),de=()=>T(at,"$error",t),fe=()=>T(Na,"$pagedNovels",t),ke=[],_e=I([]),at=I(null),st=I(!0),Fe=I(""),Oe=I(""),xe=I(""),rt=I([]),ut=I("any"),pt=I(""),dt=I(0),ft=I(9999),_t=I(0),gt=I(999999),bt=I(!1),ht=I("likes"),mt=I("desc"),it=I(20),Se=I(1),Gt=I(!0),xa=ye(_e,c=>[...new Set(c.flatMap(g=>g.tags||[]))].sort()),Sa=ye(_e,c=>[...new Set(c.map(g=>g.author))].sort()),Ca=ye(_e,c=>[...new Set(c.map(g=>g.title))].sort()),yt=(c,g)=>ye([c,g],([x,A])=>{if(!x||x.length<2)return[];const Q=x.toLowerCase();return A.filter(Y=>Y.toLowerCase().includes(Q)).slice(0,7)}),Ta=yt(Fe,Ca),Ea=yt(Oe,Sa),Aa=yt(xe,xa),Ma=ye(_e,c=>{const g={};for(const x of c)for(const A of x.tags??[])g[A]=(g[A]||0)+1;return Object.entries(g).sort(([,x],[,A])=>A-x).slice(0,50).map(([x])=>x)}),wt=ye([_e,Fe,Oe,xe,rt,ut,pt,dt,ft,_t,gt,bt,ht,mt],([c,g,x,A,Q,Y,Z,ee,ie,Ue,te,ae,le,He])=>{const ne=g.toLowerCase().trim(),se=c.filter(E=>{const j=ne===""||E.title?.toLowerCase().includes(ne)||E.id?.toString()===ne,B=x===""||E.author?.includes(x),L=!A||E.tags?.includes(A),oe=Q.length===0||Q.some(Ce=>E.tags?.includes(Ce)),ve=Y==="any"||E.is_adult?.toString()===Y,ge=Z===""||E.publication_status===Z,be=E.chapter_count>=ee&&E.chapter_count<=ie,Ie=E.like_count>=Ue&&E.like_count<=te,ce=!ae||E.cover_url&&E.cover_url.trim()!=="";return j&&B&&L&&oe&&ve&&ge&&be&&Ie&&ce});return se.sort((E,j)=>{let B=0;switch(le){case"likes":B=j.like_count-E.like_count;break;case"chapters":B=j.chapter_count-E.chapter_count;break;case"title":B=E.title.localeCompare(j.title);break}return He==="asc"?-B:B}),se}),Na=ye([wt,Se,it],([c,g,x])=>{const A=(g-1)*x,Q=A+x;return c.slice(A,Q)}),La=ye([wt,it],([c,g])=>Math.ceil(c.length/g)||1);wt.subscribe(()=>{Se.set(1)}),Wa(async()=>{try{const c=await fetch("/novelpia_metadata.jsonl");if(!c.ok)throw new Error(`HTTP error ${c.status}`);const x=(await c.text()).split(`
`).filter(Boolean).map(A=>JSON.parse(A));_e.set(x)}catch(c){at.set(`Failed to load metadata: ${c.message}.`)}finally{st.set(!1)}});function Fa(){rt.set([]),xe.set("")}function Oa(c){const g=c.target,x=g.src,A=x.includes(".webp"),Q=x.includes(".jpg");A&&!Q?g.src=x.replace(".webp",".jpg"):(g.parentElement&&g.parentElement.classList.add("no-cover"),g.style.display="none")}function Pe(c,g){c.set(g)}Ba();var $t=Gs();ms(c=>{var g=Os();ws.title="Novelpedia Browser",ia(4),q(c,g)});var kt=v(u($t),2),xt=u(kt),Pa=v(u(xt));o(xt),o(kt);var Kt=v(kt,2);{var Ha=c=>{var g=Bs(),x=u(g),A=u(x),Q=u(A);$e(Q);var Y=v(Q,2);{var Z=d=>{var F=Hs();Be(F,5,s,je,(G,H)=>{var O=Ps(),me=u(O,!0);o(O),W(()=>U(me,y(H))),K("mousedown",O,()=>Pe(Fe,y(H))),K("keydown",O,Ne=>Ne.key==="Enter"&&Pe(Fe,y(H))),q(G,O)}),o(F),q(d,F)};we(Y,d=>{s().length>0&&d(Z)})}o(A);var ee=v(A,2),ie=u(ee);$e(ie);var Ue=v(ie,2);{var te=d=>{var F=qs();Be(F,5,S,je,(G,H)=>{var O=Is(),me=u(O,!0);o(O),W(()=>U(me,y(H))),K("mousedown",O,()=>Pe(Oe,y(H))),K("keydown",O,Ne=>Ne.key==="Enter"&&Pe(Oe,y(H))),q(G,O)}),o(F),q(d,F)};we(Ue,d=>{S().length>0&&d(te)})}o(ee);var ae=v(ee,2),le=u(ae);$e(le);var He=v(le,2);{var ne=d=>{var F=Ds();Be(F,5,b,je,(G,H)=>{var O=zs(),me=u(O,!0);o(O),W(()=>U(me,y(H))),K("mousedown",O,()=>Pe(xe,y(H))),K("keydown",O,Ne=>Ne.key==="Enter"&&Pe(xe,y(H))),q(G,O)}),o(F),q(d,F)};we(He,d=>{b().length>0&&d(ne)})}o(ae),o(x);var se=v(x,2),E=v(u(se),2);Be(E,5,P,je,(d,F)=>{var G=Rs(),H=u(G);$e(H);var O,me=v(H,2),Ne=u(me,!0);o(me),o(G),W(()=>{O!==(O=y(F))&&(H.value=(H.__value=y(F))??""),U(Ne,y(F))}),Ms(ke,[],H,()=>(y(F),f()),Ra=>J(rt,Ra)),q(d,G)}),o(E);var j=v(E,2);o(se);var B=v(se,2),L=u(B),oe=v(u(L),2),ve=u(oe);$e(ve);var ge=v(ve,4);$e(ge),o(oe),o(L);var be=v(L,2),Ie=v(u(be),2),ce=u(Ie);$e(ce);var Ce=v(ce,4);$e(Ce),o(Ie),o(be);var he=v(be,2),Qe=v(u(he),2);W(()=>{$(),Re(()=>{})});var Te=u(Qe);Te.value=Te.__value="any";var Je=v(Te);Je.value=Je.__value="false";var Ee=v(Je);Ee.value=Ee.__value="true",o(Qe),o(he);var Xe=v(he,2),Ae=v(u(Xe),2);W(()=>{z(),Re(()=>{})});var qe=u(Ae);qe.value=qe.__value="";var Me=v(qe);Me.value=Me.__value="완결";var nt=v(Me);nt.value=nt.__value="연재중",o(Ae),o(Xe);var ze=v(Xe,2),Ye=v(u(ze),2);W(()=>{k(),Re(()=>{})});var De=u(Ye);De.value=De.__value=!1;var ot=v(De);ot.value=ot.__value=!0,o(Ye),o(ze),o(B),o(g),W(()=>j.disabled=!n()&&f().length===0),Le(Q,l,d=>J(Fe,d)),Le(ie,m,d=>J(Oe,d)),Le(le,n,d=>J(xe,d)),K("click",j,Fa),Le(ve,w,d=>J(dt,d)),Le(ge,_,d=>J(ft,d)),Le(ce,p,d=>J(_t,d)),Le(Ce,h,d=>J(gt,d)),Ve(Qe,$,d=>J(ut,d)),Ve(Ae,z,d=>J(pt,d)),Ve(Ye,k,d=>J(bt,d)),et(3,g,()=>Fs,()=>({duration:300})),q(c,g)};we(Kt,c=>{i()&&c(Ha)})}var St=v(Kt,2),Ct=u(St),lt=v(u(Ct),2);W(()=>{M(),Re(()=>{})});var Tt=u(lt);Tt.value=Tt.__value="likes";var Et=v(Tt);Et.value=Et.__value="chapters";var Zt=v(Et);Zt.value=Zt.__value="title",o(lt);var At=v(lt,2);W(()=>{C(),Re(()=>{})});var Mt=u(At);Mt.value=Mt.__value="desc";var jt=v(Mt);jt.value=jt.__value="asc",o(At),o(Ct);var Nt=v(Ct,2),Lt=u(Nt),Ft=v(Lt,2),Ia=u(Ft);o(Ft);var ea=v(Ft,2);o(Nt);var ta=v(Nt,2),Ot=u(ta);W(()=>{X(),Re(()=>{})});var Pt=u(Ot);Pt.value=Pt.__value=20;var Ht=v(Pt);Ht.value=Ht.__value=50;var aa=v(Ht);aa.value=aa.__value=100,o(Ot),o(ta),o(St);var qa=v(St,2);{var za=c=>{var g=Vs();et(3,g,()=>ct),q(c,g)},Da=c=>{var g=la(),x=Dt(g);{var A=Y=>{var Z=Ws(),ee=u(Z),ie=u(ee,!0);o(ee),o(Z),W(()=>U(ie,de())),et(3,Z,()=>ct),q(Y,Z)},Q=Y=>{var Z=la(),ee=Dt(Z);{var ie=te=>{var ae=Us();et(3,ae,()=>ct),q(te,ae)},Ue=te=>{var ae=Ys(),le=Dt(ae);Be(le,5,fe,B=>B.id,(B,L)=>{var oe=Xs(),ve=u(oe),ge=u(ve),be=u(ge);{var Ie=d=>{var F=Qs();q(d,F)};we(be,d=>{y(L).is_adult&&d(Ie)})}var ce=v(be,2);ia(2),o(ge);var Ce=v(ge,2),he=u(Ce),Qe=u(he,!0);o(he);var Te=v(he,2),Je=u(Te,!0);o(Te);var Ee=v(Te,2),Xe=u(Ee,!0);o(Ee);var Ae=v(Ee,2);Be(Ae,5,()=>y(L).tags?.slice(0,5),je,(d,F)=>{var G=Js(),H=u(G,!0);o(G),W(()=>U(H,y(F))),q(d,G)}),o(Ae);var qe=v(Ae,2),Me=u(qe),nt=u(Me,!0);o(Me);var ze=v(Me,2),Ye=u(ze);o(ze);var De=v(ze,2),ot=u(De);o(De),o(qe),o(Ce),o(ve),o(oe),W(d=>{Ze(oe,"href",y(L).source==="Novelpia"?`https://novelpia.com/novel/${y(L).id}`:"#"),Ze(ce,"src",y(L).cover_url),Ze(ce,"alt",`Cover for ${y(L).title??""}`),Ze(he,"title",y(L).title),U(Qe,y(L).title),U(Je,y(L).author),Ze(Ee,"title",y(L).synopsis),U(Xe,y(L).synopsis),U(nt,y(L).publication_status),U(Ye,`${y(L).chapter_count??""} Chapters`),U(ot,`❤️ ${d??""}`)},[()=>y(L).like_count.toLocaleString()]),K("error",ce,Oa),et(3,ve,()=>ct),q(B,oe)}),o(le);var He=v(le,2),ne=u(He),se=v(ne,2),E=u(se);o(se);var j=v(se,2);o(He),W(()=>{ne.disabled=N()===1,U(E,`Page ${N()??""} of ${D()??""}`),j.disabled=N()===D()}),K("click",ne,()=>Se.update(B=>B-1)),K("click",j,()=>Se.update(B=>B+1)),q(te,ae)};we(ee,te=>{fe().length===0?te(ie):te(Ue,!1)},!0)}q(Y,Z)};we(x,Y=>{de()?Y(A):Y(Q,!1)},!0)}q(c,g)};we(qa,c=>{R()?c(za):c(Da,!1)})}o($t),W(()=>{U(Pa,` ${i()?"Hide Filters":"Show Filters"}`),Lt.disabled=N()===1,U(Ia,`Page ${N()??""} of ${D()??""}`),ea.disabled=N()===D()}),K("click",xt,()=>Gt.update(c=>!c)),Ve(lt,M,c=>J(ht,c)),Ve(At,C,c=>J(mt,c)),K("click",Lt,()=>Se.update(c=>c-1)),K("click",ea,()=>Se.update(c=>c+1)),Ve(Ot,X,c=>J(it,c)),q(e,$t),ys(),r()}export{sr as component};
